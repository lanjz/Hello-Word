# 关于静态资源的输出路径

关于路径先分清楚在路径名前有没有带`/`的情况下他们的区别：

假设我们的HTML页面有引入一张 `bg.png` 的图片

- `/assets/bg.png`: 相对于服务(server-relative)

- `assets/bg.png`: 相对于 HTML 页面

- `./assets/`: 相对于 HTML 页面

[官方](https://www.webpackjs.com/configuration/output/#output-publicpath)对于`output.publicPath`的解释：

- 参数：`string`|`function`,在多数情况下此选项的值都会以/结束

对于按需加载(on-demand-load)或加载外部资源(external resources)（如JS文件、图片、文件等）来说，`output.publicPath` 是很重要的选项。
如果指定了一个错误的值，则在加载这些资源时会收到 `404` 错误。

从这里可以知道一个信息，这个配置影响的是按需加载和静态资源的引入路径

来一个没有配置`output.publicPath`的例子和打包结果

```
// webpack.config.js
entry: {
    index: './src/index.js',
},
output: {
    filename: '[name].js',
    chunkFilename: '[name].bundle.js',
    path: path.resolve(__dirname, 'dist'),
},

```
打包后引入的JS文件地址是：

```
<script type="text/javascript" src="index.js"></script>
```

HTML打开也是能正常加这个JS文件，接下我们加入`output.publicPath`

```
output: {
        filename: '[name].js',
        chunkFilename: '[name].bundle.js',
        path: path.resolve(__dirname, 'dist'),
		publicPath: '/out/',
    },
```

打包后会发现这个JS加载失败了，因为他们引入路径是`src="/out/index.js"`，可以看到路径前多了`output.publicPath`配置的路径

所以`output.publicPath`一般用于生产环境中，假如生产环境我们需要将静态资源放在其它目录或者放入 CDN时，就需要配置`output.publicPath`，
这样才能正确访问到真正的资源

打包静态资源的路径除了受`output.publicPath`影响，也会被 Loader 的配置影响，比如`file-loader`,`file-loader`的配置中有两个配置属性
`outputPath`和`publicPath`,

- `outputPath`: 指定输出文件放在哪个路径下，这个路径是会生成在输出目录中的

- `publicPath`: 跟`output.publicPath`类似，会在资源路径前加上`publicPath`，一般也是用于生产

```
// webpack.config.js
 {
    test: /\.(png|svg|jpg|gif)$/,
    use: [
        {
            loader: 'file-loader',
            options: {
                name: '[name].[ext]',
                outputPath: 'images/',
                publicPath: 'assets/'
            }
        }
    ]
},

// 给body添加样式

body{
    background: url("../imgs/bg.png");
}

```

打包后，图片的路径为`url(/assets/bg.png)`

并且 `file-loader`中的`publicPath`和`output.publicPath`同时存在时， `file-loader`中的`publicPath`会覆盖`output.publicPath`，
如果`file-loader`中的`publicPath`没设置，则使用`output.publicPath`
