<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

</body>
<script>
  function fetch(time, sue = true, info){
    return new Promise((resolve, reject) => {
      let callback = sue ? resolve : reject
      setTimeout(() => {
        callback(info)
      }, time)
    })
  }


  var gen = function* (){
    var r1 = yield fetch(1000, true, 1)
    console.log(r1);
    var r2 = yield fetch(1000, true, 2)
    console.log(r2);
    var r3 = yield fetch(1000, true, 3)
    console.log(r3);
  };
  var g = gen();

 /* g.next().value.then(function(data){
    g.next(data).value.then(function(data){
      g.next(data);
    });
  });
*/

  function co(fn) {
    const g = fn()
    function next() {
      const gg = g.next()
      if(gg.done) return gg.value
      gg.value.then(res => {
        console.log('res', res)
        next()
      })
    }
    next()
  }
  co(gen)

  /* Promise.any([fetch(1000, false), fetch(1000)])
    .then(res => {
      console.log(res)
    })
    .catch(err => {
      console.log('err', err) // err, err
    }) */
  // Hello

</script>
<script>
	function _new2(fn, ...arg){
		const obj = {}
		console.log('obj', obj.constructor.toString())
		obj.__proto__ = fn.prototype
		fn.apply(obj, arg)
        console.log('obj22', obj.constructor.toString())
		return obj
	}

	// 效果一样
	function _new(fn, ...arg){
		const ttt = Object.create({})
        console.log('ttt', ttt.constructor.toString())
		const obj = Object.create(fn.prototype)
        console.log('obj3', obj.constructor.toString())
		fn.apply(obj, arg)
		return obj
	}

	function t(arg){
		this.a = arg
	}

	var t1 = _new(t, 1)
    // console.log(t1.constructor)
	var t2 = _new2(t, 10)
    // console.log(t2.constructor)
	var t3 = new t(11)
    // console.log(t3.constructor)
    const itb = {
        [Symbol.Iterable]() {
            return {
                i: 0,
                next() {
                    if (this.i < 3) {
                        return { value: this.i++, done: false };
                    }
                    return { value: undefined, done: true };
                }
            }
        }
    }
    function carrry(fn){
        const arg = arguments.slice(1)
        return function (arg1){
            return fn(...arg1, ...arg)
        }
    }
</script>
</html>